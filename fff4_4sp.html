<!DOCTYPE html>
<html>
<head>
  <title>Buscador de Factores</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-size: 18px;
      margin: 0;
      padding: 5px;
      background-color: darkslategrey;
      display: flex;
      flex-direction: column;
      align-items: center;
    font-family: "dunbar-tall", sans-serif;
    }
    h1 {
      font-size: 28px;
      text-align: center;
      color: lightyellow;
      margin-top: 20px;
	font-family: "epitaph", sans-serif;
    }
    .tab-container {
      display: flex;
      width: 100%;
    }
    .tab {      flex: 1;
      padding: 15px;
		font-weight: 200; 
      cursor: pointer;
      border-left: 1px solid #363636;
      border-right: 1px solid #363636;
      border-bottom: 1px solid #363636;
      text-align: center;
	  background-color: lightyellow;
	  border-top-left-radius: 8px;
	  border-top-right-radius: 8px;
	  margin-top: 5px;
    }
    .tab.active {
      background-color: #ccc;
	  border-bottom: 0PX;
	  border-top-left-radius: 10px;
	  border-top-right-radius: 10px;
	  margin-top: 0px;
    }
	#equalTab.active {
      background-color: lightblue;
      border-left: 0px;
    }
    #nearTab.active {
      background-color: lightgreen;
      border-right: 0px;
    } 
	.inputLabel {
	  padding-top: 5px;
	  padding-bottom:  5px;
	}
    .lightgreen-bg {
      background-color: lightgreen !important;
    }
    .input-container {
      display: flex;
      justify-content: space-between;
      width: 100%;
    }
    .input-container div {
      flex: 1;
      text-align: center;
    }
    input sup, inputr sub {
      font-size: 0.85em;
    }
    input {
      font-size: 18px;
      max-width: 100%;
      text-align: center;
      padding: 10px;
      margin-top: 10px;
      background-color: lightyellow;
      width: 70%;
    font-family: "dunbar-tall", sans-serif;
    }
	   /* Result Styles */
    #marksResult {
      text-align: center;
    }
    #segmentResult {
      text-align: center;
		
    }
	.length {
		width:33%;
		float: left;
		text-align: center;
		padding-top: 15px;
		padding-bottom: 14px;
		background-color: lightblue;
        border-bottom: 1px solid #363636;
	}
	.burn {
		width:34%;
		float: left;
		text-align: center;
		padding-top: 15px;
		padding-bottom: 14px;
		background-color: lightblue;
        border-bottom: 1px solid #363636;
	}
	.segmentType {
		width:33%;
		float: left;
		text-align: center;
		padding-top: 15px;
		padding-bottom: 14px;
		background-color: lightblue;
        border-bottom: 1px solid #363636;
	}
    .resultsBG {
      text-align: center;
      background-color: lightyellow;
      width: 100%;
    }
    .factor sup, .factor sub {
      font-size: 0.85em;
    }
	.readme-container{      
	  display: flex;
      justify-content: space-between;
	  text-align: center;
      width: 100%;
	  border: none;
	  }
	.readme-container button {
      flex: 1;
      text-align: center;text-decoration: underline;
	  background-color: lightyellow;
	  border: none;
	  border-bottom-left-radius: 10px;
	  border-bottom-right-radius: 10px;
	  font-size: 18px;
	  padding-bottom: 10px;
      font-family: "dunbar-tall", sans-serif;
      }
	  .close-btn {
	  text-decoration: underline;
      cursor: pointer;
	  }
	  .info{
      float:right;
      text-align: center;
      background-color: lightyellow;
      width: 100%;
		  padding-left: 5px;
		  padding-right: 5px;
	  }
	  .credits{
      
      text-align: center;
      background-color: lightyellow;
		border-bottom-left-radius: 10px;
		border-bottom-right-radius: 10px;
      width: 100%;
	  }
	  
.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.4);
}
#showModalBtn {
  color: black;
  cursor: pointer;
}
.modal-content {
  background-color: lightyellow;
  margin: 5% auto;
  padding: 20px;
	border-radius: 14px;
  border: 1px solid #888;
  width: 80%;
  max-height: calc(100vh - 40px); /* 20px top and bottom margin */
  overflow-y: auto; 
}
@media screen and (orientation:landscape) {
  .modal-content {
    max-height: calc(100vh - 80px); /* Adjusted height for landscape */
  }
}
  </style>
	
  <link href="https://use.typekit.net/iwc3riw.css" rel="stylesheet"/>
</head>
<body>
  <div class="tab-container">
    <div id="equalTab" class="tab active" onclick="changeTab('equal')">Igual</div>
    <div id="nearTab" class="tab" onclick="changeTab('near')">Cercano</div>
  </div>
  <form class="input-container">
    <div class="length">
      <label for="length">Longitud:</label><br>
      <input type="text" id="length">
    </div>
    <div class="burn">
      <label for="endDistance"> Inicio:</label><br>
      <input type="text" id="endDistance">
    </div>
    <div class="segmentType">
      <div id="dynamicLabel">Segmentos:</div>
      <input type="text" id="valueUsed">
    </div>
  </form>
  <div class="resultsBG">
    <p id="segmentResult"></p>
    <p id="marksResult"></p>
  </div>
	
	
	<div class="readme-container">
	<button id="showModalBtn">Instrucciones</button>
	
	
	<div id="instructionsModal" class="modal">
       <div class="modal-content">
Toque "Igual" para segmentos iguales o "Cercano" para segmentos cercanos a una longitud espec&iacute;fica.
<br><br>
Complete el campo "Longitud" con la longitud total de su material.
<br><br>
Introduce la distancia que dejar&aacute;s en cada extremo en el campo "Inicio".
<br><br>
En el &uacute;ltimo campo, ingrese el n&uacute;mero de segmentos o el tama&ntilde;o aproximado de cada segmento, seg&uacute;n el modo elegido.
<br><br>
Las longitudes y factores de segmento calculados aparecer&aacute;n debajo de los campos de entrada.
	<br><br>	<span class="close-btn" id="closeModalBtn">Close</span>	
	  </div>
	</div>
	
	
	
	</div>
	
	
	
	
	
  <script>
// Helper function to calculate the greatest common divisor
const gcd = (a, b) => b ? gcd(b, a % b) : a;

// Helper function to convert decimal numbers into readable fractions
const toReadableFraction = x => {
  if (isNaN(x)) return '';
  const whole = Math.floor(x), fraction = x - whole;
  let [numerator, denominator] = [Math.round(fraction * 16), 16], divisor = gcd(numerator, denominator);
  [numerator, denominator] = [numerator / divisor, denominator / divisor];
  return whole ? (numerator ? `${whole} &nbsp;&nbsp;<span class='factor'><sup>${numerator}</sup>/<sub>${denominator}</sub></span>` : `${whole}`) : (numerator ? `<span class='factor'><sup>${numerator}</sup>/<sub>${denominator}</sub></span>` : '0');
};

// Helper function to parse input values from the form
const parseInput = input => {
  if (!input) return NaN;
  if (input.includes(' ')) {
    const [whole, fraction] = input.split(' '), [numerator, denominator] = fraction.split('/').map(Number);
    return isNaN(numerator) || isNaN(denominator) || denominator === 0 ? NaN : Number(whole) + (numerator / denominator);
  } else if (input.includes('/')) {
    const [numerator, denominator] = input.split('/').map(Number);
    return isNaN(numerator) || isNaN(denominator) || denominator === 0 ? NaN : numerator / denominator;
  } else {
    return Number(input);
  }
};

// Function to handle tab changes
const changeTab = choice => {
  document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
  document.getElementById(choice + 'Tab').classList.add('active');
  document.getElementById('dynamicLabel').innerText = choice === 'equal' ? 'Segmentos:' : 'Pulgadas:';

  const elementsToChange = document.querySelectorAll('.length, .burn, .segmentType');
  if (choice === 'near') {
    elementsToChange.forEach(el => el.classList.add('lightgreen-bg'));
  } else {
    elementsToChange.forEach(el => el.classList.remove('lightgreen-bg'));
  }

  // Trigger the calculation function when tab is changed
  calculate();
};

// Main function to calculate segment lengths and factors
const calculate = () => {
  const [lengthInput, endDistanceInput, valueUsedInput] = [document.getElementById('length').value, document.getElementById('endDistance').value, document.getElementById('valueUsed').value];
  const method = document.querySelector('.tab.active').id.startsWith('equal') ? 'equal' : 'near';
  const [length, endDistance, valueUsed] = [parseInput(lengthInput), parseInput(endDistanceInput), parseInput(valueUsedInput)];

  if (isNaN(length) || isNaN(endDistance) || isNaN(valueUsed)) {
    document.getElementById('segmentResult').innerText = 'Please enter valid numbers or fractions.';
    return;
  }

  let remainingLength = length - 2 * endDistance, segments = [toReadableFraction(endDistance)], segmentLength;

  if (method === 'equal') {
    segmentLength = remainingLength / valueUsed;
    for (let i = 0; i < valueUsed; i++) segments.push(toReadableFraction((i + 1) * segmentLength + endDistance));
  } else if (method === 'near') {
    const exactNumSegments = remainingLength / valueUsed;
    const numSegments = Math.round(exactNumSegments);  // This change ensures rounding to the nearest whole number

    segmentLength = remainingLength / numSegments; // Recalculate segment length based on actual number of segments
    for (let i = 0; i < numSegments; i++) segments.push(toReadableFraction((i + 1) * segmentLength + endDistance));
  }

  document.getElementById('segmentResult').innerHTML = `Longitud del Segmento: ${toReadableFraction(segmentLength)}"`;
  document.getElementById('marksResult').innerHTML = `Factores:<br><br>${segments.join('"<hr><br>')} "`;
};

// Debouncing function to prevent excessive calculations
let debounceTimer;
const debounceCalculate = () => {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(calculate, 500);
};

// Event listeners for input changes
document.getElementById('length').addEventListener('input', debounceCalculate);
document.getElementById('endDistance').addEventListener('input', debounceCalculate);
document.getElementById('valueUsed').addEventListener('input', debounceCalculate);

// Event listeners for tab changes
document.getElementById('equalTab').addEventListener('click', () => changeTab('equal'));
document.getElementById('nearTab').addEventListener('click', () => changeTab('near'));

// Instructions modal handling
const modal = document.getElementById('instructionsModal');
const showModalBtn = document.getElementById('showModalBtn');
const closeModalBtn = document.getElementById('closeModalBtn');

showModalBtn.addEventListener('click', () => {
  modal.style.display = "block";
});

closeModalBtn.addEventListener('click', () => {
  modal.style.display = "none";
});

window.addEventListener('click', function(event) {
  if (event.target === modal) {
    modal.style.display = "none";
  }
});

// Initial calculation on page load
calculate();
  </script>
</body>
</html>